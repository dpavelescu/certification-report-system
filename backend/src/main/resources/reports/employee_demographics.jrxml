<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports 
              http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
              name="employee_demographics" 
              pageWidth="842" 
              pageHeight="595" 
              orientation="Landscape"
              columnWidth="782" 
              leftMargin="30" 
              rightMargin="30" 
              topMargin="25" 
              bottomMargin="25">
    
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    
    <!-- Parameters -->
    <parameter name="REPORT_TITLE" class="java.lang.String" isForPrompting="false">
        <defaultValueExpression><![CDATA["Employee Demographics Report"]]></defaultValueExpression>
    </parameter>
    <parameter name="GENERATION_DATE" class="java.lang.String" isForPrompting="false"/>
    <parameter name="TOTAL_EMPLOYEES" class="java.lang.Integer" isForPrompting="false">
        <defaultValueExpression><![CDATA[0]]></defaultValueExpression>
    </parameter>
    <parameter name="COMPANY_NAME" class="java.lang.String" isForPrompting="false">
        <defaultValueExpression><![CDATA["CertReport Systems"]]></defaultValueExpression>
    </parameter>
    
    <!-- Fields -->
    <field name="id" class="java.lang.String"/>
    <field name="firstName" class="java.lang.String"/>
    <field name="lastName" class="java.lang.String"/>
    <field name="email" class="java.lang.String"/>
    <field name="department" class="java.lang.String"/>
    <field name="position" class="java.lang.String"/>
    <field name="hireDate" class="java.time.LocalDateTime"/>
    
    <!-- Variables for statistics -->
    <variable name="DEPT_COUNT" class="java.lang.Integer" calculation="DistinctCount">
        <variableExpression><![CDATA[$F{department}]]></variableExpression>
    </variable>
    <variable name="RECORD_COUNT" class="java.lang.Integer" calculation="Count">
        <variableExpression><![CDATA[1]]></variableExpression>
    </variable>
    
    <!-- Title Section -->
    <title>
        <band height="120" splitType="Stretch">
            <!-- Professional Header Background -->
            <rectangle>
                <reportElement mode="Opaque" x="0" y="0" width="782" height="50" backcolor="#2E5C8A"/>
            </rectangle>
            <staticText>
                <reportElement x="0" y="5" width="782" height="40" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="24" isBold="true"/>
                </textElement>
                <text><![CDATA[Employee Demographics Report]]></text>
            </staticText>
            
            <!-- Company Name and Generation Date -->
            <textField>
                <reportElement x="0" y="60" width="400" height="25" forecolor="#555555"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="16" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{COMPANY_NAME}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="400" y="60" width="382" height="25" forecolor="#555555"/>
                <textElement textAlignment="Right" verticalAlignment="Middle">
                    <font fontName="Arial" size="12"/>
                </textElement>
                <textFieldExpression><![CDATA["Generated: " + new java.text.SimpleDateFormat("MMMM dd, yyyy 'at' HH:mm").format(new java.util.Date())]]></textFieldExpression>
            </textField>
            
            <!-- Summary Statistics -->
            <rectangle>
                <reportElement mode="Opaque" x="0" y="95" width="200" height="20" backcolor="#E8F4FD"/>
                <graphicElement>
                    <pen lineWidth="1.0" lineColor="#4A90C2"/>
                </graphicElement>
            </rectangle>
            <staticText>
                <reportElement x="5" y="97" width="100" height="16" forecolor="#2E5C8A"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <text><![CDATA[Total Employees:]]></text>
            </staticText>
            <textField>
                <reportElement x="105" y="97" width="90" height="16" forecolor="#2E5C8A"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{TOTAL_EMPLOYEES}]]></textFieldExpression>
            </textField>
            
            <rectangle>
                <reportElement mode="Opaque" x="210" y="95" width="200" height="20" backcolor="#E8F4FD"/>
                <graphicElement>
                    <pen lineWidth="1.0" lineColor="#4A90C2"/>
                </graphicElement>
            </rectangle>
            <staticText>
                <reportElement x="215" y="97" width="100" height="16" forecolor="#2E5C8A"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <text><![CDATA[Departments:]]></text>
            </staticText>
            <textField>
                <reportElement x="315" y="97" width="90" height="16" forecolor="#2E5C8A"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$V{DEPT_COUNT}]]></textFieldExpression>
            </textField>
        </band>
    </title>
    
    <!-- Professional Column Headers -->
    <columnHeader>
        <band height="40" splitType="Stretch">
            <!-- Header Background -->
            <rectangle>
                <reportElement mode="Opaque" x="0" y="10" width="782" height="30" backcolor="#4A90C2"/>
            </rectangle>
            
            <staticText>
                <reportElement x="5" y="15" width="80" height="20" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <text><![CDATA[Employee ID]]></text>
            </staticText>
            <staticText>
                <reportElement x="90" y="15" width="140" height="20" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <text><![CDATA[Full Name]]></text>
            </staticText>
            <staticText>
                <reportElement x="235" y="15" width="180" height="20" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <text><![CDATA[Email Address]]></text>
            </staticText>
            <staticText>
                <reportElement x="420" y="15" width="120" height="20" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <text><![CDATA[Department]]></text>
            </staticText>
            <staticText>
                <reportElement x="545" y="15" width="130" height="20" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <text><![CDATA[Position]]></text>
            </staticText>
            <staticText>
                <reportElement x="680" y="15" width="95" height="20" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isBold="true"/>
                </textElement>
                <text><![CDATA[Hire Date]]></text>
            </staticText>
        </band>
    </columnHeader>
    
    <!-- Enhanced Detail Rows -->
    <detail>
        <band height="30" splitType="Stretch">
            <!-- Alternating Row Colors -->
            <rectangle>
                <reportElement mode="Opaque" x="0" y="0" width="782" height="30" backcolor="#FFFFFF">
                    <printWhenExpression><![CDATA[$V{REPORT_COUNT} % 2 == 1]]></printWhenExpression>
                </reportElement>
            </rectangle>
            <rectangle>
                <reportElement mode="Opaque" x="0" y="0" width="782" height="30" backcolor="#F8F9FA">
                    <printWhenExpression><![CDATA[$V{REPORT_COUNT} % 2 == 0]]></printWhenExpression>
                </reportElement>
            </rectangle>
            
            <!-- Vertical Separator Lines -->
            <line>
                <reportElement x="85" y="0" width="1" height="30" forecolor="#E0E0E0"/>
            </line>
            <line>
                <reportElement x="230" y="0" width="1" height="30" forecolor="#E0E0E0"/>
            </line>
            <line>
                <reportElement x="415" y="0" width="1" height="30" forecolor="#E0E0E0"/>
            </line>
            <line>
                <reportElement x="540" y="0" width="1" height="30" forecolor="#E0E0E0"/>
            </line>
            <line>
                <reportElement x="675" y="0" width="1" height="30" forecolor="#E0E0E0"/>
            </line>
            
            <!-- Data Fields with Professional Formatting -->
            <textField>
                <reportElement x="5" y="5" width="75" height="20" forecolor="#333333"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="9"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{id}.length() > 8 ? $F{id}.substring(0, 8) + "..." : $F{id}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="90" y="5" width="135" height="20" forecolor="#333333"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="9" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{firstName} + " " + $F{lastName}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="235" y="5" width="175" height="20" forecolor="#555555"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{email}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="420" y="5" width="115" height="20" forecolor="#333333"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="9"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{department}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="545" y="5" width="125" height="20" forecolor="#333333"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="9"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{position}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="680" y="5" width="90" height="20" forecolor="#666666"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[new java.text.SimpleDateFormat("MMM dd, yyyy").format(java.sql.Timestamp.valueOf($F{hireDate}))]]></textFieldExpression>
            </textField>
            
            <!-- Subtle Bottom Border -->
            <line>
                <reportElement x="0" y="29" width="782" height="1" forecolor="#E0E0E0"/>
            </line>
        </band>
    </detail>
    
    <!-- Professional Page Footer -->
    <pageFooter>
        <band height="40" splitType="Stretch">
            <!-- Footer Background -->
            <rectangle>
                <reportElement mode="Opaque" x="0" y="10" width="782" height="25" backcolor="#F0F0F0"/>
                <graphicElement>
                    <pen lineWidth="1.0" lineColor="#CCCCCC"/>
                </graphicElement>
            </rectangle>
            
            <!-- Confidentiality Notice -->
            <staticText>
                <reportElement x="10" y="15" width="300" height="15" forecolor="#666666"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="8" isItalic="true"/>
                </textElement>
                <text><![CDATA[Confidential - For Internal Use Only]]></text>
            </staticText>
            
            <!-- Page Information -->
            <textField>
                <reportElement x="590" y="15" width="180" height="15" forecolor="#666666"/>
                <textElement textAlignment="Right" verticalAlignment="Middle">
                    <font fontName="Arial" size="9"/>
                </textElement>
                <textFieldExpression><![CDATA["Page " + $V{PAGE_NUMBER} + " of " + $V{PAGE_COUNT}]]></textFieldExpression>
            </textField>
            
            <!-- Report Generation Info -->
            <textField>
                <reportElement x="320" y="15" width="260" height="15" forecolor="#666666"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="8"/>
                </textElement>
                <textFieldExpression><![CDATA["Generated by CertReport System"]]></textFieldExpression>
            </textField>
        </band>
    </pageFooter>
    
    <!-- Summary Section -->
    <summary>
        <band height="50" splitType="Stretch">
            <rectangle>
                <reportElement mode="Opaque" x="0" y="10" width="782" height="30" backcolor="#E8F4FD"/>
                <graphicElement>
                    <pen lineWidth="2.0" lineColor="#2E5C8A"/>
                </graphicElement>
            </rectangle>
            
            <staticText>
                <reportElement x="20" y="15" width="150" height="20" forecolor="#2E5C8A"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Report Summary:]]></text>
            </staticText>
            
            <textField>
                <reportElement x="170" y="15" width="200" height="20" forecolor="#2E5C8A"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="11" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Total Records: " + $V{RECORD_COUNT}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="380" y="15" width="200" height="20" forecolor="#2E5C8A"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font fontName="Arial" size="11" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Unique Departments: " + $V{DEPT_COUNT}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="580" y="15" width="190" height="20" forecolor="#2E5C8A"/>
                <textElement textAlignment="Right" verticalAlignment="Middle">
                    <font fontName="Arial" size="10"/>
                </textElement>
                <textFieldExpression><![CDATA["Report completed at " + new java.text.SimpleDateFormat("HH:mm:ss").format(new java.util.Date())]]></textFieldExpression>
            </textField>
        </band>
    </summary>
    
</jasperReport>
